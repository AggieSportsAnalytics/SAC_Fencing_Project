{"id":"node_modules/@tensorflow-models/pose-detection/shared/calculators/create_ssd_anchors.js","dependencies":[{"name":"/Users/vpenumarti/Desktop/CS/SAC_Fencing_Project/pose-detection/demos/upload_video/node_modules/@tensorflow-models/pose-detection/shared/calculators/create_ssd_anchors.js.map","includedInParent":true,"mtime":1699061167880},{"name":"/Users/vpenumarti/Desktop/CS/SAC_Fencing_Project/pose-detection/demos/upload_video/package.json","includedInParent":true,"mtime":1699064044040},{"name":"/Users/vpenumarti/Desktop/CS/SAC_Fencing_Project/pose-detection/demos/upload_video/.babelrc","includedInParent":true,"mtime":1699061165674}],"generated":{"js":"\"use strict\";\n/**\n * @license\n * Copyright 2021 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createSsdAnchors = void 0;\n// ref:\n// https://github.com/google/mediapipe/blob/350fbb2100ad531bc110b93aaea23d96af5a5064/mediapipe/calculators/tflite/ssd_anchors_calculator.cc\nfunction createSsdAnchors(config) {\n    // Set defaults.\n    if (config.reduceBoxesInLowestLayer == null) {\n        config.reduceBoxesInLowestLayer = false;\n    }\n    if (config.interpolatedScaleAspectRatio == null) {\n        config.interpolatedScaleAspectRatio = 1.0;\n    }\n    if (config.fixedAnchorSize == null) {\n        config.fixedAnchorSize = false;\n    }\n    var anchors = [];\n    var layerId = 0;\n    while (layerId < config.numLayers) {\n        var anchorHeight = [];\n        var anchorWidth = [];\n        var aspectRatios = [];\n        var scales = [];\n        // For same strides, we merge the anchors in the same order.\n        var lastSameStrideLayer = layerId;\n        while (lastSameStrideLayer < config.strides.length &&\n            config.strides[lastSameStrideLayer] === config.strides[layerId]) {\n            var scale = calculateScale(config.minScale, config.maxScale, lastSameStrideLayer, config.strides.length);\n            if (lastSameStrideLayer === 0 && config.reduceBoxesInLowestLayer) {\n                // For first layer, it can be specified to use predefined anchors.\n                aspectRatios.push(1);\n                aspectRatios.push(2);\n                aspectRatios.push(0.5);\n                scales.push(0.1);\n                scales.push(scale);\n                scales.push(scale);\n            }\n            else {\n                for (var aspectRatioId = 0; aspectRatioId < config.aspectRatios.length; ++aspectRatioId) {\n                    aspectRatios.push(config.aspectRatios[aspectRatioId]);\n                    scales.push(scale);\n                }\n                if (config.interpolatedScaleAspectRatio > 0.0) {\n                    var scaleNext = lastSameStrideLayer === config.strides.length - 1 ?\n                        1.0 :\n                        calculateScale(config.minScale, config.maxScale, lastSameStrideLayer + 1, config.strides.length);\n                    scales.push(Math.sqrt(scale * scaleNext));\n                    aspectRatios.push(config.interpolatedScaleAspectRatio);\n                }\n            }\n            lastSameStrideLayer++;\n        }\n        for (var i = 0; i < aspectRatios.length; ++i) {\n            var ratioSqrts = Math.sqrt(aspectRatios[i]);\n            anchorHeight.push(scales[i] / ratioSqrts);\n            anchorWidth.push(scales[i] * ratioSqrts);\n        }\n        var featureMapHeight = 0;\n        var featureMapWidth = 0;\n        if (config.featureMapHeight.length > 0) {\n            featureMapHeight = config.featureMapHeight[layerId];\n            featureMapWidth = config.featureMapWidth[layerId];\n        }\n        else {\n            var stride = config.strides[layerId];\n            featureMapHeight = Math.ceil(config.inputSizeHeight / stride);\n            featureMapWidth = Math.ceil(config.inputSizeWidth / stride);\n        }\n        for (var y = 0; y < featureMapHeight; ++y) {\n            for (var x = 0; x < featureMapWidth; ++x) {\n                for (var anchorId = 0; anchorId < anchorHeight.length; ++anchorId) {\n                    var xCenter = (x + config.anchorOffsetX) / featureMapWidth;\n                    var yCenter = (y + config.anchorOffsetY) / featureMapHeight;\n                    var newAnchor = { xCenter: xCenter, yCenter: yCenter, width: 0, height: 0 };\n                    if (config.fixedAnchorSize) {\n                        newAnchor.width = 1.0;\n                        newAnchor.height = 1.0;\n                    }\n                    else {\n                        newAnchor.width = anchorWidth[anchorId];\n                        newAnchor.height = anchorHeight[anchorId];\n                    }\n                    anchors.push(newAnchor);\n                }\n            }\n        }\n        layerId = lastSameStrideLayer;\n    }\n    return anchors;\n}\nexports.createSsdAnchors = createSsdAnchors;\nfunction calculateScale(minScale, maxScale, strideIndex, numStrides) {\n    if (numStrides === 1) {\n        return (minScale + maxScale) * 0.5;\n    }\n    else {\n        return minScale + (maxScale - minScale) * strideIndex / (numStrides - 1);\n    }\n}\n"},"sourceMaps":{"js":{"version":3,"file":"create_ssd_anchors.js","sourceRoot":"","sources":["../../../src/shared/calculators/create_ssd_anchors.ts"],"names":[],"mappings":"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","sourcesContent":[null]}},"error":null,"hash":"77dae97591df15d69f72cf13eabf88ae","cacheData":{"env":{}}}